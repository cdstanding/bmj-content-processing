<?xml version="1.0" encoding="UTF-8"?>
<pages monograph_type="standard">
  <page label="highlights.summary">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/highlights,
            /monograph-full/monograph-info/related-topics
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/highlights  
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="highlights.overview">
    <retrieval-xquery>
      <body>
        <![CDATA[
              /monograph-full/diagnosis/diagnostic-factors, 
              /monograph-full/diagnosis/tests,
              /monograph-full/treatment/timeframes
          ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
              /monograph-full/diagnosis/diagnostic-factors, 
              /monograph-full/diagnosis/tests,
              /monograph-full/treatment/timeframes 
          ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="basics.definition">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/definition 
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/definition  
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="basics.epidemiology">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/epidemiology
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/epidemiology  
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="basics.aetiology">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/etiology
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/etiology  
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="basics.pathophysiology">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/pathophysiology    
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/pathophysiology    
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="basics.classification">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/classifications    
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/classifications    
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="prevention.primary">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/prevention    
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/prevention
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="prevention.screening">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/screening    
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/screening    
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="prevention.secondary">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/followup/recommendations/preventive-actions   
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/followup/recommendations/preventive-actions  
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="diagnosis.case-history">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/vignettes,   
            /monograph-full/basics/other-presentations
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/basics/vignettes   
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="diagnosis.step-by-step">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/approach,
            /monograph-full/diagnosis/guidelines  
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/approach   
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="diagnosis.history-and-examination">
    <retrieval-xquery>
      <body>
        <![CDATA[
                <symptoms>
                    <diagnostic-factors>
                        <key-diagnostic-factors>
                        {
                            for $frequency in ("common", "uncommon")
                            return /monograph-full/diagnosis/diagnostic-factors/factor[@key-factor='true' and @frequency=$frequency]
                        }
                        </key-diagnostic-factors>
                        <other-diagnostic-factors>
                        {
                            for $frequency in ("common", "uncommon")
                            return /monograph-full/diagnosis/diagnostic-factors/factor[@key-factor='false' and @frequency=$frequency]
                        }
                        </other-diagnostic-factors>
                    </diagnostic-factors>
                    <risk-factors>
                        <strong-risk-factors>
                        {
                            for $x in /monograph-full/basics/risk-factors/risk-factor[@strength = 'strong']
                            return $x
                        }
                        </strong-risk-factors>
                        <weak-risk-factors>
                        {
                            for $x in /monograph-full/basics/risk-factors/risk-factor[@strength = 'weak']
                            return $x
                        }
                        </weak-risk-factors>
                    </risk-factors>
                </symptoms>
            ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/diagnostic-factors,
            /monograph-full/basics/risk-factors 
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="diagnosis.tests">
    <retrieval-xquery>
      <body>
        <![CDATA[
	            <ordered-tests>
	              <initial-tests>
	              {
	              for $x in /monograph-full/diagnosis/tests/test
	              where $x/@order="initial"
	              return $x
	              }
	              </initial-tests>
	              <other-tests>
	              {
	              for $x in /monograph-full/diagnosis/tests/test
	              where $x/@order="subsequent"
	              return $x
	              }
	              </other-tests>
	              <emerging-tests>
	              {
	              for $x in /monograph-full/diagnosis/tests/test
	              where $x/@order="emerging"
	              return $x
	              }
	              </emerging-tests>
	            </ordered-tests>
              ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/tests 
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="diagnosis.differential">
    <retrieval-xquery>
      <body>
        <![CDATA[
        	/monograph-full/diagnosis/differentials
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/differentials  
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="diagnosis.criteria">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/diagnostic-criteria   
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/diagnostic-criteria   
        ]]>
      </body>
    </presence-xquery>
  </page>
  
  <page label="diagnosis.screening">
    <retrieval-xquery />
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/screening    
        ]]>
      </body>
    </presence-xquery>
  </page>
  
  <page label="diagnosis.guidelines">
    <retrieval-xquery>
      <body>
        <![CDATA[
            <diagnosis-guidlines>
            {
              for $region in ("Asia", "Africa", "Europe", "International", "Latin America", "North America", "Oceania")
              let $x:= /monograph-full/diagnosis/guidelines/guideline[ @region=$region]
              return if($x/*) 
                        then <region id='{data($region)}'>{$x}</region>
                        else <xxx></xxx>
            }
            <non-region>
            {
              for $y in /monograph-full/diagnosis/guidelines/guideline 
              return if($y[@region]) 
                     then <xxx></xxx>
                     else $y
            }
            </non-region>
            </diagnosis-guidlines>
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/diagnosis/guidelines   
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="treatment.step-by-step">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/treatment/approach 
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/treatment/approach 
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="treatment.details">
    <retrieval-xquery>
      <body>
        <![CDATA[
                <timeframes>
				{
				    for $timeframe in ("presumptive", "acute", "ongoing")
				    return 
				        <timeframe type="{upper-case(substring($timeframe, 1, 1))}{substring($timeframe, 2)}">
				        {/monograph-full/treatment/timeframes/timeframe[@type=$timeframe]/*}
				        </timeframe>
				}
				</timeframes>
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/treatment/timeframes 
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="treatment.details.patientgroup">
    <retrieval-xquery>
      <head>
        <![CDATA[
              declare variable $param1 external;
              declare variable $param2 external;
          ]]>
      </head>
      <body>
        <![CDATA[
            <treatment>
            {
                for $x in /monograph-full/treatment/timeframes/timeframe/pt-groups/pt-group[@generated-id=$param1]
                return 
                if($param2="0") then
                <timeframe type="{upper-case(substring($x/../../@type, 1, 1))}{substring($x/../../@type, 2)}">
                     <selected-patient-group-level>parent</selected-patient-group-level>
                {$x}
                </timeframe>
                else
                <timeframe type="{upper-case(substring($x/../../@type, 1, 1))}{substring($x/../../@type, 2)}">
                    {if($x/tx-options/*) then
                        <contains-parent-treatments>true</contains-parent-treatments>
                    else 
                        <contains-parent-treatments>false</contains-parent-treatments>
                    }
                    <selected-patient-group-level>child</selected-patient-group-level>
                    <pt-group generated-id="{$x/@generated-id}">
                        {$x/name}
                        {$x/tx-options}
                        <pt-groups>
                            <pt-group generated-id="{$param2}">
                                {$x/pt-groups/pt-group[@generated-id=$param2]/name}
                                {$x/pt-groups/pt-group[@generated-id=$param2]/tx-options}
                            </pt-group>
                        </pt-groups>
                    </pt-group>
                </timeframe>
            }
            </treatment>

        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery />
  </page>
  <page label="treatment.emerging">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/treatment/emerging-txs  
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/treatment/emerging-txs  
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="treatment.guidelines">
    <retrieval-xquery>
      <body>
        <![CDATA[
            <treatment-guidlines>
            {
              for $region in ("Asia", "Africa", "Europe", "International", "Latin America", "North America", "Oceania")
              let $x:= /monograph-full/treatment/guidelines/guideline[ @region=$region]
              return if($x/*) 
                        then <region id='{data($region)}'>{$x}</region>
                        else <xxx></xxx>
            }
            <non-region>
            {
              for $y in /monograph-full/treatment/guidelines/guideline 
              return if($y[@region]) 
                     then <xxx></xxx>
                     else $y
            }
            </non-region>
            </treatment-guidlines>
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/treatment/guidelines  
        ]]>
      </body>
    </presence-xquery>
  </page>

  <!-- 
    For evidence XQueries see xqueries/systematic-review-xqueries.xml
  -->

  <page label="treatment.evidence">
    <retrieval-xquery xqref="systematic-reviews.questions.retrieval" />
    <presence-xquery xqref="systematic-reviews.questions.presence" />
  </page>
  <page label="treatment.evidence.question">
    <retrieval-xquery xqref="systematic-review.question" />
    <presence-xquery />
  </page>
  <page label="treatment.evidence.intervention">
    <retrieval-xquery xqref="systematic-review.intervention" />
    <presence-xquery />
  </page>
  <page label="treatment.evidence.table">
    <retrieval-xquery xqref="systematic-review.table" />
    <presence-xquery />
  </page>
  <page label="treatment.evidence.glossary">
    <retrieval-xquery xqref="systematic-review.glossary" />
    <presence-xquery />
  </page>
  <page label="treatment.evidence.key-points">
    <retrieval-xquery xqref="systematic-review.key-points"/>
    <presence-xquery />
  </page>
  <page label="treatment.evidence.background">
    <retrieval-xquery xqref="systematic-review.background"/>
    <presence-xquery />
  </page>


  <page label="treatment.evidence.score">
    <retrieval-xquery xqref="treatment.evidence.score" />
    <presence-xquery />
  </page>
  <page label="treatment.evidence.scorepopup">
    <retrieval-xquery xqref="treatment.evidence.score" />
    <presence-xquery />
  </page>

  <page label="treatment.evidence.references">
    <retrieval-xquery xqref="systematic-review.references" />
    <presence-xquery />
  </page>
  <page label="treatment.evidence.reference">
    <retrieval-xquery xqref="systematic-review.reference" />
    <presence-xquery />
  </page>

  <page label="follow-up.recommendations">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/followup/recommendations   
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/followup/recommendations/monitoring,
            /monograph-full/followup/recommendations/patient-instructions
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="follow-up.complications">
    <retrieval-xquery>
      <body>
        <![CDATA[
                    <complications>
	                {
	                    for $timeframe in ("short term", "long term", "variable")
	                    return 
	                        for $likelihood in ("high", "medium", "low")
	                        return 
	                        /monograph-full/followup/complications/complication[@timeframe=$timeframe and @likelihood=$likelihood]
	                    
	                    
	                }
	                </complications> 
              ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/followup/complications   
        ]]>
      </body>
    </presence-xquery>
  </page>
  <page label="follow-up.prognosis">
    <retrieval-xquery>
      <body>
        <![CDATA[
            /monograph-full/followup/outlook   
        ]]>
      </body>
    </retrieval-xquery>
    <presence-xquery>
      <body>
        <![CDATA[
            /monograph-full/followup/outlook   
        ]]>
      </body>
    </presence-xquery>
  </page>

  <page label="resources.references">
    <retrieval-xquery xqref="resources.references.retrieval" />
    <presence-xquery xqref="resources.references.presence" />
  </page>

  <page label="resources.images">
    <retrieval-xquery xqref="resources.images" />
    <presence-xquery xqref="resources.images.presence" />
  </page>
  
  <page label="resources.images.print">
    <retrieval-xquery xqref="resources.images.print" />
    <presence-xquery />
  </page>
  
  <page label="resources.online-resources">
    <retrieval-xquery xqref="resources.online-resources" />
    <presence-xquery xqref="resources.online-resources" />
  </page>

  <page label="resources.patient-leaflets">
    <retrieval-xquery xqref="resources.patient-leaflets" />
    <presence-xquery xqref="resources.patient-leaflets" />
  </page>

  <page label="resources.credits">
    <retrieval-xquery xqref="resources.credits.retrieval" />
    <presence-xquery xqref="resources.credits.presence" />
  </page>

  <!-- Page queries used by the popup feature -->
  <page label="resources.reference.bp">
    <retrieval-xquery xqref="resources.reference.bp" />
    <presence-xquery />
  </page>
  <page label="resources.image.bp">
    <retrieval-xquery xqref="resources.image.bp" />
    <presence-xquery />
  </page>
  <page label="treatment.evidence.image">
    <retrieval-xquery xqref="systematic-review.image" />
    <presence-xquery />
  </page>
  <page label="resources.guideline.nice">
    <retrieval-xquery xqref="resources.nice-guideline" />
    <presence-xquery />
  </page>
</pages>
